name: Test Supabase Connection

on: workflow_dispatch

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
    - name: 📥 Descargar código
      uses: actions/checkout@v4
      
    - name: 🐍 Configurar Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.9'
        
    - name: 📚 Instalar supabase
      run: pip install supabase
      
    - name: 🧪 Ejecutar test de conexión
      env:
        SUPABASE_URL: ${{ secrets.SUPABASE_URL }}
        SUPABASE_KEY: ${{ secrets.SUPABASE_KEY }}
      run: |
        python -c "
import os
from supabase import create_client

print('=== 🔍 TEST SUPABASE CONNECTION ===')

url = os.environ['SUPABASE_URL']
key = os.environ['SUPABASE_KEY']

print('🔗 URL:', url)
print('🔑 Key (primeros 10 chars):', key[:10] + '...')

try:
    print('🔄 Intentando conectar...')
    supabase = create_client(url, key)
    print('✅ CONEXIÓN EXITOSA!')
    
    print('📊 Probando acceso a tabla...')
    response = supabase.table('vendedoras_data').select('*').limit(1).execute()
    print('✅ TABLA ACCESIBLE!')
    
except Exception as e:
    print('❌ ERROR:', str(e))
"
