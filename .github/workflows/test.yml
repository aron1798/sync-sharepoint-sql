name: Test Supabase Connection

on: workflow_dispatch

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
    - name: ğŸ“¥ Descargar cÃ³digo
      uses: actions/checkout@v4
      
    - name: ğŸ Configurar Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.9'
        
    - name: ğŸ“š Instalar supabase
      run: pip install supabase
      
    - name: ğŸ§ª Ejecutar test de conexiÃ³n
      env:
        SUPABASE_URL: ${{ secrets.SUPABASE_URL }}
        SUPABASE_KEY: ${{ secrets.SUPABASE_KEY }}
      run: |
        python -c "
import os
from supabase import create_client

print('=== ğŸ” TEST SUPABASE CONNECTION ===')

url = os.environ['SUPABASE_URL']
key = os.environ['SUPABASE_KEY']

print('ğŸ”— URL:', url)
print('ğŸ”‘ Key (primeros 10 chars):', key[:10] + '...')

try:
    print('ğŸ”„ Intentando conectar...')
    supabase = create_client(url, key)
    print('âœ… CONEXIÃ“N EXITOSA!')
    
    print('ğŸ“Š Probando acceso a tabla...')
    response = supabase.table('vendedoras_data').select('*').limit(1).execute()
    print('âœ… TABLA ACCESIBLE!')
    
except Exception as e:
    print('âŒ ERROR:', str(e))
"
