name: Test Supabase Connection

on: [workflow_dispatch]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'
          
      - name: Install dependencies
        run: pip install supabase
        
      - name: Test connection
        env:
          SUPABASE_URL: ${{ secrets.SUPABASE_URL }}
          SUPABASE_KEY: ${{ secrets.SUPABASE_KEY }}
        run: python -c "
import os
from supabase import create_client

print('Testing Supabase connection...')
url = os.environ.get('SUPABASE_URL')
key = os.environ.get('SUPABASE_KEY')

if not url or not key:
    print('ERROR: Missing secrets')
    exit(1)

try:
    supabase = create_client(url, key)
    print('✅ Connected successfully!')
except Exception as e:
    print(f'❌ Connection failed: {e}')
"
